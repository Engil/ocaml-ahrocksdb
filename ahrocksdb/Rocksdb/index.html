<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rocksdb (ahrocksdb.Rocksdb)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">ahrocksdb</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Rocksdb</span></h1></header><p>A binding to RocksDB</p><p>This library is a binding to Facebook's RocksDB library.
This library attempts to provide a layer on top of Rock's C FFI adapting it as
much as possible to OCaml idioms.
It aims to cover most of the C FFI in the long run, along with tests to ensure
no function is left never called and untested.</p><div class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-error.Msg" class="anchored"><td class="def constructor"><a href="#type-error.Msg" class="anchor"></a><code><span class="keyword">| </span></code><code>`Msg<span class="keyword"> of </span>string</code></td></tr></table><code> ]</code><code></code></div><div class="doc"></div></div><div class="spec module" id="module-Options"><a href="#module-Options" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Options/index.html">Options</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"><p>Opaque database handle</p></div></div><div class="spec val" id="val-open_db"><a href="#val-open_db" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>open_db : config:<a href="Options/index.html#type-config">Options.config</a> <span class="keyword">&#8209;&gt;</span> name:string <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">open_db options name</code> will return an handle to the database in case
of success or the error returned by RocksDB in case of failure.
<code class="code">name</code> is the path to the database.</p></div></div><div class="spec val" id="val-open_db_read_only"><a href="#val-open_db_read_only" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>open_db_read_only : ?&#8288;fail_on_wal:bool <span class="keyword">&#8209;&gt;</span> config:<a href="Options/index.html#type-config">Options.config</a> <span class="keyword">&#8209;&gt;</span> name:string <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">open_db options name</code> will return a read-only handle to the database in case
of success or the error returned by RocksDB in case of failure.
<code class="code">name</code> is the path to the database.
<code class="code">fail_on_wal</code> returns an error if write log is not empty</p></div></div><div class="spec val" id="val-open_db_with_ttl"><a href="#val-open_db_with_ttl" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>open_db_with_ttl : config:<a href="Options/index.html#type-config">Options.config</a> <span class="keyword">&#8209;&gt;</span> name:string <span class="keyword">&#8209;&gt;</span> ttl:int <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">open_db_with_ttl options name ttl</code> will return an handle to the database in case
of success or the error returned by RocksDB in case of failure.
<code class="code">name</code> is the path to the database.
<code class="code">ttl</code> Time in seconds after which a key should be removed (best-effort basis, during compaction)</p></div></div><div class="spec val" id="val-put"><a href="#val-put" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>put : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="Options/Write_options/index.html#type-t">Options.Write_options.t</a> <span class="keyword">&#8209;&gt;</span> key:string <span class="keyword">&#8209;&gt;</span> value:string <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">put db write_options key value</code> will write at key <code class="code">key</code> the value <code class="code">value</code>, on database <code class="code">db</code>.
Return unit on success, RocksDB reported error on error.</p></div></div><div class="spec val" id="val-delete"><a href="#val-delete" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>delete : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="Options/Write_options/index.html#type-t">Options.Write_options.t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">delete db write_options key</code> will delete key <code class="code">key</code> on database <code class="code">db</code>.
Return unit on success, RocksDB reported error on error.</p></div></div><div class="spec val" id="val-get"><a href="#val-get" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="Options/Read_options/index.html#type-t">Options.Read_options.t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> ([ `Not_found | `Found of string ], <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">get db read_options key</code> will fetch key <code class="code">key</code> on database <code class="code">db</code>.
Returns `Ok value if the key is found, `Not_found otherwise, and `Error if a failure occurred.</p></div></div><div class="spec val" id="val-flush"><a href="#val-flush" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>flush : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="Options/Flush_options/index.html#type-t">Options.Flush_options.t</a> <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">flush db flush_options</code> will flush all pending memtables on database <code class="code">db</code>.
Return unit on success, RocksDB reported error on error.</p></div></div><div class="spec val" id="val-compact_now"><a href="#val-compact_now" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>compact_now : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">compact_now db</code> will initiate a compaction on all ranges available in database. This is an asynchronous operation, returning unit once operation is started.</p></div></div><div class="spec val" id="val-stats"><a href="#val-stats" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>stats : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string option, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">stats db</code> will return the accumulated stats for this database handle as an optional string form</p></div></div><div class="spec val" id="val-get_cache_usage"><a href="#val-get_cache_usage" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_cache_usage : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (int, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"></div></div><div class="spec val" id="val-close_db"><a href="#val-close_db" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>close_db : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result</code></div><div class="doc"><p><code class="code">close db</code> explicitly closes the db handle. Any further access will raise an error</p></div></div><div class="spec module" id="module-Batch"><a href="#module-Batch" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Batch/index.html">Batch</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>Batch processing
RocksDB allows to batch operations through a dedicated batch object that must be fed to <a href="Batch/index.html#val-write">write</a>.
A batch object <a href="Batch/index.html#type-batch">Batch.batch</a> is a collection of operation to run on a database. (like <a href="Batch/index.html#val-put">Batch.put</a> or delete).</p></div></div><div class="spec module" id="module-Iterator"><a href="#module-Iterator" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Iterator/index.html">Iterator</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Perf_context"><a href="#module-Perf_context" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Perf_context/index.html">Perf_context</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div></body></html>